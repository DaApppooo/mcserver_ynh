#:schema https://raw.githubusercontent.com/YunoHost/apps/master/schemas/manifest.v2.schema.json

packaging_format = 2

id = "mcserver"
name = "Vanilla Minecraft Server"
description.en = "Packaging of the official java minecraft server. Need a client to connect to the server."
description.fr = "Packaging du serveur minecraft java officiel. NÃ©cessite un client pour se connecter au serveur."

version = "1.21.11~ynh6"

maintainers = [ "appo.tcp@gmail.com" ]

[upstream]
license = "MIT"
website = "https://www.minecraft.net/en-us"

[integration]
yunohost = ">= 11.2.18"
helpers_version = "2.1"
architectures = "all"
multi_instance = true

ldap = "not_relevant"
sso = "not_relevant"

disk = "5000M"
ram.build = "2000M"
ram.runtime = "2000M"

[antifeatures]
not-totally-free-upstream.en = "Relies on software that is not free and open source in order to run (the minecraft server)."
paid-content.en = "Depends, for users, entirely on a paid service (minecraft)."

[install]
    [install.path]
    type = "path"
    default = "/mcserver"

    [install.init_main_permission]
    # this is a generic question - ask strings are automatically handled by YunoHost's core
    type = "group"
    default = "admins"

    [install.eula]
    ask.en = "Do you agree to mojang's eula, found here: https://aka.ms/MinecraftEULA"
    type = "boolean"
    default = false

    [install.memory]
    ask.en = "How much ram (in megabytes) do you want to allocate (at most) for this server:"
    type = "number"
    default = 1024
    min = 0
    max = 99999999999999

    [install.accepts_transfers]
    ask.en="Does your server accepts transfers ?"
    type='boolean'
    default=false

    [install.allow_flight]
    ask.en="Does your server allows flight ?"
    type='boolean'
    default=false


    [install.broadcast_console_to_ops]
    ask.en="Broadcast console to ops ?"
    type='boolean'
    default=true
    [install.broadcast_rcon_to_ops]
    ask.en="Broadcast rcon to ops ?"
    type='boolean'
    default=true
    [install.bug_report_link]
    ask.en="Link to report bugs to (empty to ignore):"
    type="string"
    default=''
    optional=true
    [install.difficulty]
    ask.en="Difficulty"
    type="select"
    choices = [ "peaceful", "easy", "normal", "hard" ]
    default = "easy"
    [install.enable_code_of_conduct]
    ask.en="Enable code of conduct ?"
    type='boolean'
    default=false
    [install.enable_jmx_monitoring]
    ask.en="Enable jmx monitoring ?"
    type='boolean'
    default=false
    [install.enable_query]
    ask.en="Enable query ?"
    type='boolean'
    default=false
    [install.enable_rcon]
    ask.en="Enable rcon ? (web interface won't work if not enabled)"
    type='boolean'
    default=true
    [install.enable_status]
    ask.en="Enable status ?"
    type='boolean'
    default=true
    [install.enforce_secure_profile]
    ask.en="Enforce secure profile:"
    type='boolean'
    default=true
    [install.enforce_whitelist]
    ask.en="Whitelist only ?"
    type='boolean'
    default=false
    [install.entity_broadcast_range_percentage]
    ask.en="Entity broadcast range percentage:"
    type='range'
    default='100'
    min = "0"
    max = "100"
    [install.force_gamemode]
    ask.en="Force gamemode ?"
    type='boolean'
    default=false
    [install.function_permission_level]
    ask.en="Function permission level:"
    type='number'
    default=2
    [install.gamemode]
    ask.en="Gamemode:"
    type="select"
    choices = [ "creative", "survival", "spectator" ]
    default='survival'
    [install.generate_structures]
    ask.en="Generate structures ?"
    type='boolean'
    default=true
    [install.generator_settings]
    ask.en="Generator settings:"
    type="string"
    default='{}'
    [install.hardcore]
    ask.en="Activate hardcore ?"
    type='boolean'
    default=false
    [install.hide_online_players]
    ask.en="Hide online players ?"
    type='boolean'
    default=false
    [install.initial_disabled_packs]
    ask.en="Initial disabled packs:"
    type="string"
    default=''
    optional=true
    [install.initial_enabled_packs]
    ask.en="Initial enabled packs:"
    type="string"
    default='vanilla'
    [install.level_name]
    ask.en="Name:"
    type="string"
    default='world'
    [install.level_seed]
    ask.en="Seed:"
    type="string"
    default=''
    optional=true
    [install.level_type]
    ask.en="Type:"
    type="string"
    default='minecraft\\:normal'
    [install.log_ips]
    ask.en="Log ips ?"
    type='boolean'
    default=true
    [install.management_server_allowed_origins]
    ask.en="management-server-allowed-origins"
    type="string"
    default=''
    optional=true
    [install.management_server_enabled]
    ask.en="management-server-enabled"
    type='boolean'
    default=false
    [install.management_server_host]
    ask.en="management-server-host"
    type="string"
    default='localhost'
    [install.management_server_port]
    ask.en="management-server-port"
    type="number"
    default=0
    [install.management_server_tls_enabled]
    ask.en="management-server-tls-enabled"
    type='boolean'
    default=true
    [install.management_server_tls_keystore]
    ask.en="management-server-tls-keystore"
    type="string"
    default=''
    optional=true
    [install.management_server_tls_keystore_password]
    ask.en="management-server-tls-keystore-password"
    type="string"
    optional=true
    default=''
    [install.max_chained_neighbor_updates]
    ask.en="Maximum number of chained neighbor updates:"
    type="number"
    default=1000000
    [install.max_players]
    ask.en="Maximum number of players:"
    type="number"
    default=20
    [install.max_tick_time]
    ask.en="Maximum tick time:"
    type="number"
    default=60000
    [install.max_world_size]
    ask.en="Maximum world size:"
    type="number"
    default=29999984
    [install.motd]
    ask.en="Server title:"
    type="string"
    default='A Minecraft Server'
    [install.network_compression_threshold]
    ask.en="Network compression threshold"
    type="number"
    default=256
    [install.online_mode]
    ask.en="online-mode"
    type='boolean'
    default=true
    [install.op_permission_level]
    ask.en="Permission level for operators:"
    type="number"
    default=4
    [install.pause_when_empty_seconds]
    ask.en="Pause when empty after x seconds:"
    type="number"
    default=60
    [install.player_idle_timeout]
    ask.en="Kick idle players after x seconds (0 for never):"
    type="number"
    default=0
    [install.prevent_proxy_connections]
    ask.en="Prevent proxy connections"
    type='boolean'
    default=false
    [install.query_port]
    ask.en="Query port (if query is enabled):"
    type="number"
    default=25565
    [install.rate_limit]
    ask.en="Rate limit (0 for no limit):"
    type="number"
    default=0
    [install.rcon_password]
    ask.en="Rcon password (if rcon is enabled):"
    type="string"
    optional=true
    default=''
    [install.rcon_port]
    ask.en="Rcon port (if rcon is enabled, and DO NOT EXPOSE THIS PORT):"
    type="number"
    default=25575
    [install.region_file_compression]
    ask.en="Region file compressions:"
    type="string"
    default='deflate'
    [install.require_resource_pack]
    ask.en="Require ressource pack:"
    type='boolean'
    default=false
    [install.resource_pack]
    ask.en="Ressource pack:"
    type="string"
    optional=true
    default=''
    [install.resource_pack_id]
    ask.en="Ressource pack id:"
    type="string"
    optional=true
    default=''
    [install.resource_pack_prompt]
    ask.en="ressource-pack-prompt"
    type="string"
    optional=true
    default=''
    [install.resource_pack_sha1]
    ask.en="Sha1 hash of the ressource pack:"
    type="string"
    optional=true
    default=''
    [install.server_ip]
    ask.en="Server ip:"
    type="string"
    default='0.0.0.0'
    [install.server_port]
    ask.en="Server port (you need to open the ports on this server yourself):"
    type="number"
    default=25565
    [install.simulation_distance]
    ask.en="Simulation distance:"
    type="number"
    default=10
    [install.spawn_protection]
    ask.en="Spawn protection radius:"
    type="number"
    default=16
    [install.status_heartbeat_interval]
    ask.en="status-heartbeat-interval"
    type="number"
    default=0
    [install.sync_chunk_writes]
    ask.en="Synchronize chunk writes:"
    type='boolean'
    default=true
    [install.text_filtering_config]
    ask.en="Text filtering configuration:"
    type="string"
    optional=true
    default=''
    [install.text_filtering_version]
    ask.en="Text filtering version:"
    type="number"
    default=0
    [install.use_native_transport]
    ask.en="use-native-transport"
    type='boolean'
    default=true
    [install.view_distance]
    ask.en="View distance:"
    type="number"
    default=10
    [install.white_list]
    ask.en="Use a whitelist ?"
    type='boolean'
    default=false

[resources]
    [resources.sources]
    [resources.sources.main]
    url = "https://piston-data.mojang.com/v1/objects/64bb6d763bed0a9f1d632ec347938594144943ed/server.jar"
    sha256 = "f83b8e093865806f931c7e34aae41b177d4c076335263dd124c75d6d65dd1726"
    autoupdate.strategy = "latest_github_releas"

    [resources.system_user]

    [resources.install_dir]

    [resources.data_dir]
    subdirs = [".mcserver/worlds"]

    [resources.permissions]
    main.allowed = "admins"

    [resources.apt]
    packages = ["default-jre"]
